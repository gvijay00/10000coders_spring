# ğŸŒŸ **Validation + Exception Handling**

**Goal:** Make students write clean, safe, and error-free Spring Boot APIs.

---

# ğŸŸ¦ **1. Why Validation is Needed? (Beginner Explanation)**

When users send data, it may be:

âŒ Empty
âŒ Wrong format
âŒ Missing fields

Example:
Student name = â€œâ€ (empty)
Email = â€œabc.comâ€ (wrong format)

We must **validate** data before saving it to database.

Spring Boot provides **Hibernate Validator**.

---

# ğŸŸ© **2. Add Validation Dependency (pom.xml)**

If not already added:

```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-validation</artifactId>
</dependency>
```

---

# ğŸŸ¥ **3. Add Validation on DTO Fields**

Use annotations like:

* @NotNull
* @NotBlank
* @Email
* @Min
* @Max

### Example: StudentDTO

```java
public class StudentDTO {

    @NotBlank(message = "Name cannot be blank")
    private String name;

    @Email(message = "Invalid email format")
    private String email;

    @Min(value = 18, message = "Age must be atleast 18")
    private int age;
}
```

---

# ğŸŸ§ **4. Apply @Valid in Controller Method**

Use @Valid to activate validation.

```java
@PostMapping("/students")
public ResponseEntity<StudentDTO> save(@Valid @RequestBody StudentDTO dto) {
    return ResponseEntity.ok(dto);
}
```

When invalid data is sent â†’
Spring returns **400 Bad Request** with error message.

---

# ğŸŸ¥ **5. How Errors Look Without Custom Handler?**

Example response:

```json
{
  "errors": [
    "Name cannot be blank",
    "Invalid email format"
  ]
}
```

But format is not user-friendly â†’ so we create **Global Exception Handler**.

---

# ğŸŸ© **6. What is Exception Handling? (Beginner Explanation)**

When something goes wrong in application, we must handle exceptions using:

* @ControllerAdvice
* @ExceptionHandler

This makes API errors clean and readable.

---

# ğŸŸ¦ **7. Global Exception Handler (Beginner Level)**

### Step 1: Create Error Response Class

```java
public class ErrorResponse {
    private String message;
    private LocalDateTime time;

    public ErrorResponse(String message, LocalDateTime time) {
        this.message = message;
        this.time = time;
    }
}
```

---

### Step 2: Create GlobalExceptionHandler

```java
@ControllerAdvice
public class GlobalExceptionHandler {

    @ExceptionHandler(MethodArgumentNotValidException.class)
    public ResponseEntity<?> handleValidationErrors(MethodArgumentNotValidException ex) {

        List<String> errors = ex.getBindingResult()
                .getFieldErrors()
                .stream()
                .map(err -> err.getDefaultMessage())
                .toList();

        return ResponseEntity
                .badRequest()
                .body(errors);
    }
}
```

This handles validation errors for the whole project.

---

# ğŸŸ¥ **8. Handle Custom Exceptions**

### Step 1: Create custom exception class

```java
public class StudentNotFoundException extends RuntimeException {
    public StudentNotFoundException(String message) {
        super(message);
    }
}
```

---

### Step 2: Throw exception in service

```java
public Student getStudent(int id) {
    return repo.findById(id)
            .orElseThrow(() -> new StudentNotFoundException("Student not found"));
}
```

---

### Step 3: Handle custom exception

```java
@ExceptionHandler(StudentNotFoundException.class)
public ResponseEntity<?> handleStudentNotFound(StudentNotFoundException ex) {
    return ResponseEntity.status(HttpStatus.NOT_FOUND)
            .body(new ErrorResponse(ex.getMessage(), LocalDateTime.now()));
}
```

---

# ğŸŸ§ **9. Mini Project**

### Build a Student module with:

âœ” Validations
âœ” Global Exception Handler
âœ” Custom exception
âœ” Proper error messages

---

### Example JSON input:

```json
{
  "name": "",
  "email": "abc.com",
  "age": 12
}
```

### Expected Validation Output:

```
[
  "Name cannot be blank",
  "Invalid email format",
  "Age must be atleast 18"
]
```

### Example Custom Exception Output:

```
{
  "message": "Student not found",
  "time": "2025-12-01T09:30:25"
}
```

---

# ğŸ“ **10. Assignments**

### **Task 1 â€“ Employee Validation**

EmployeeDTO fields:

* name â†’ @NotBlank
* salary â†’ @Min(10000)
* email â†’ @Email

Build controller:

* POST /employee
* GET /employee/{id}

Throw custom exception if not found.

---

### **Task 2 â€“ Global Exception Structure**

Return JSON like:

```json
{
  "errors": ["message1", "message2"],
  "timestamp": "current-time"
}
```

---

### **Task 3 â€“ Test With Wrong Inputs**

Ask students to test:

* Blank name
* Wrong email
* Age < 18

---
