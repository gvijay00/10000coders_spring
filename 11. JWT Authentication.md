

# ğŸŒŸ **JWT Authentication**

**Goal:** Students understand what JWT is, why we use it, and how token-based login works in Spring Boot.

---

# ğŸŸ¦ **1. What is Authentication? (Beginner Explanation)**

**Authentication = Who are you?**
Example:

* Login with username & password
* Verify identity

Earlier: Session-Based Login
Now: **Token-Based Login (JWT)** â†’ used in all modern applications.

---

# ğŸŸ© **2. What is JWT? (Very Simple)**

JWT = **JSON Web Token**

It is a **string-based token** that proves the user is authenticated.

Example JWT:

```
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

The token is returned after login â†’ client stores it â†’ sends token for secured APIs.

---

# ğŸŸ§ **3. Why JWT? (Simple Points)**

âœ” Stateless (server does not store session)
âœ” Fast
âœ” Secure
âœ” Used in Microservices
âœ” Works for Web, Mobile, Android, iOS

---

# ğŸŸ¥ **4. JWT Structure (Very Beginner-Friendly)**

A JWT has 3 parts:

```
HEADER.PAYLOAD.SIGNATURE
```

### Example:

```
xxxxx.yyyyy.zzzzz
```

### 1ï¸âƒ£ Header

Contains:

* Algorithm
* Type (JWT)

### 2ï¸âƒ£ Payload

Contains user data (claims):

* Username
* Roles
* Expiry

### 3ï¸âƒ£ Signature

Used to verify the token is original.

---

# ğŸŸ¦ **5. JWT Flow Diagram (Beginner)**

```
Login API (username + password)
          â†“
Spring Boot verifies user
          â†“
Spring Boot returns JWT token
          â†“
Client stores the token
          â†“
Client sends token in every request (Authorization: Bearer <token>)
          â†“
Spring Boot verifies token
          â†“
Access granted
```

---

# ğŸŸ© **6. Add Required Dependencies**

```xml
<!-- Security -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-security</artifactId>
</dependency>

<!-- JWT Library -->
<dependency>
    <groupId>io.jsonwebtoken</groupId>
    <artifactId>jjwt-api</artifactId>
    <version>0.11.5</version>
</dependency>

<dependency>
    <groupId>io.jsonwebtoken</groupId>
    <artifactId>jjwt-impl</artifactId>
    <version>0.11.5</version>
    <scope>runtime</scope>
</dependency>

<dependency>
    <groupId>io.jsonwebtoken</groupId>
    <artifactId>jjwt-jackson</artifactId>
    <version>0.11.5</version>
    <scope>runtime</scope>
</dependency>
```

---

# ğŸŸ¥ **7. Step 1 â€“ Create User Entity (to store login users)**

```java
@Entity
public class User {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private int id;

    private String username;
    private String password;
    private String role;
}
```

---

# ğŸŸ§ **8. Step 2 â€“ Create Login Request DTO**

```java
public class LoginRequest {
    private String username;
    private String password;
}
```

---

# ğŸŸ¦ **9. Step 3 â€“ Create JWT Utility Class (Token Generator)**

```java
@Component
public class JwtUtil {

    private String secret = "mysecretkey";

    public String generateToken(String username) {
        return Jwts.builder()
                .setSubject(username)
                .setIssuedAt(new Date())
                .setExpiration(new Date(System.currentTimeMillis() + 1000 * 60 * 60))
                .signWith(SignatureAlgorithm.HS256, secret)
                .compact();
    }

    public String extractUsername(String token) {
        return Jwts.parser()
                .setSigningKey(secret)
                .parseClaimsJws(token)
                .getBody()
                .getSubject();
    }
}
```

---

# ğŸŸ¥ **10. Step 4 â€“ Security Configuration (Very Beginner)**

```java
@Configuration
@EnableWebSecurity
public class SecurityConfig {

    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http.csrf().disable()
            .authorizeHttpRequests()
            .requestMatchers("/login").permitAll()
            .anyRequest().authenticated()
            .and()
            .httpBasic();

        return http.build();
    }
}
```

ğŸ‘‰ Later we will replace **httpBasic()** with **JWT Filter**.

---

# ğŸŸ« **11. Step 5 â€“ Authentication Service**

Check username + password from database.

```java
@Service
public class AuthService {

    @Autowired
    private UserRepository repo;

    @Autowired
    private JwtUtil jwtUtil;

    public String login(String username, String password) {
        User user = repo.findByUsername(username);

        if (user != null && user.getPassword().equals(password)) {
            return jwtUtil.generateToken(username);
        }
        return "Invalid Username or Password";
    }
}
```

---

# ğŸŸ¦ **12. Step 6 â€“ Login API (Returns JWT Token)**

```java
@RestController
public class AuthController {

    @Autowired
    private AuthService service;

    @PostMapping("/login")
    public String login(@RequestBody LoginRequest request) {
        return service.login(request.getUsername(), request.getPassword());
    }
}
```

---

# â­ **13. TEST in Postman**

### POST â†’ `/login`

Body:

```json
{
  "username": "kumar",
  "password": "12345"
}
```

You receive:

```
eyJhbGciOiJIUzI1NiJ9...
```

This is your **JWT Token**.

---

# ğŸŸ§ **14. Step 7 â€“ Protect APIs Using JWT Filter (Beginner)**

This filter reads token from header â†’ validates it.

```java
@Component
public class JwtFilter extends OncePerRequestFilter {

    @Autowired
    private JwtUtil jwtUtil;

    @Override
    protected void doFilterInternal(HttpServletRequest request,
                                    HttpServletResponse response,
                                    FilterChain filterChain)
                                    throws ServletException, IOException {

        String authHeader = request.getHeader("Authorization");

        if (authHeader != null && authHeader.startsWith("Bearer ")) {
            String token = authHeader.substring(7);
            String username = jwtUtil.extractUsername(token);

            if (username != null) {
                System.out.println("Token valid for user: " + username);
            }
        }

        filterChain.doFilter(request, response);
    }
}
```

---

# ğŸŸ¥ **15. Allow Filter in SecurityConfig**

```java
@Bean
public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {

    http.csrf().disable()
        .authorizeHttpRequests()
        .requestMatchers("/login").permitAll()
        .anyRequest().authenticated()
        .and()
        .addFilterBefore(jwtFilter, UsernamePasswordAuthenticationFilter.class);

    return http.build();
}
```

---

# ğŸŸ¦ **16. Step 8 â€“ Access Secured API**

Create a sample protected API:

```java
@GetMapping("/home")
public String home() {
    return "Welcome - You are authenticated!";
}
```

### To access â†’ send token:

Header:

```
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9....
```

---

# ğŸŸ© **17. Final JWT Flow Summary (Beginner)**

### 1ï¸âƒ£ Login â†’ send username & password

### 2ï¸âƒ£ Server validates

### 3ï¸âƒ£ Server generates JWT token

### 4ï¸âƒ£ Client stores token (local storage)

### 5ï¸âƒ£ For every API request â†’ client sends token

### 6ï¸âƒ£ Server validates token

### 7ï¸âƒ£ If valid â†’ access granted

---

# ğŸ“ **18. Mini Project**

Build:

### APIs:

1. **POST /register** â†’ save user
2. **POST /login** â†’ return JWT token
3. **GET /products** â†’ only accessible using valid token

---
