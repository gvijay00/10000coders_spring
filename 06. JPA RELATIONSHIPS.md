# ğŸŒŸ **JPA RELATIONSHIPS**

**Goal:** Students will understand how tables are connected in MySQL using JPA.

---

# ğŸŸ¦ **1. What are Relationships? (Beginner Explanation)**

In databases, tables are linked using:

* **Primary Key (PK)**
* **Foreign Key (FK)**

JPA allows Java classes to connect just like database tables.

---

# ğŸŸ© **2. Types of JPA Relationships**

1. **One-To-One**
2. **One-To-Many**
3. **Many-To-One**
4. **Many-To-Many**

We will cover each with a **diagram + example**.

---

# ğŸŸ¥ **3. ONE-TO-ONE Relationship**

### Meaning:

One record in Table A â†’ One record in Table B

Example:
A **Person** has **one** Passport.

### Diagram:

```
Person ---- 1 : 1 ---- Passport
```

---

### âœ” Example Code

#### Person.java

```java
@Entity
public class Person {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private int id;

    private String name;

    @OneToOne
    private Passport passport;
}
```

#### Passport.java

```java
@Entity
public class Passport {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private int id;

    private String passportNumber;
}
```

### Database Result:

A foreign key will appear in **Person table**.

---

# ğŸŸ§ **4. MANY-TO-ONE Relationship**

### Meaning:

Many records â†’ belong to one parent.

Example:
Many students have **one** college.

### Diagram:

```
Students (Many) -----> College (One)
```

---

### âœ” Example Code

#### Student.java

```java
@Entity
public class Student {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private int id;

    private String name;

    @ManyToOne
    private College college;
}
```

#### College.java

```java
@Entity
public class College {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private int id;

    private String collegeName;
}
```

### Database Result:

A **college_id** foreign key appears inside **student table**.

---

# ğŸŸ¥ **5. ONE-TO-MANY (Opposite of Many-To-One)**

### Meaning:

One parent â†’ Many children.

Example:
One **College** has many **Students**

### Diagram:

```
College (One) <---- Students (Many)
```

---

### âœ” Example Code

Use **mappedBy** to indicate the link.

#### College.java

```java
@Entity
public class College {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private int id;

    private String collegeName;

    @OneToMany(mappedBy = "college")
    private List<Student> students;
}
```

#### Student.java (same as above)

```java
@ManyToOne
private College college;
```

---

# ğŸŸ© **6. MANY-TO-MANY Relationship**

### Meaning:

Many records connect to many records.

Example:
A Student can take many Courses
A Course can have many Students

### Diagram:

```
Students (Many) <----> Courses (Many)
```

---

### âœ” Example Code

#### Student.java

```java
@Entity
public class Student {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private int id;

    private String name;

    @ManyToMany
    private List<Course> courses;
}
```

#### Course.java

```java
@Entity
public class Course {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private int id;

    private String title;
}
```

### Database Result:

A new **join table** will be created:

```
student_courses
```

Containing:

* student_id
* courses_id

---

# ğŸŸª **7. CASCADE Types (Beginner Explanation)**

Cascade means:

> If parent is saved/deleted â†’ children also saved/deleted.

### Common Cascade Types:

* **CascadeType.ALL** â€“ apply all
* **CascadeType.PERSIST** â€“ save child automatically
* **CascadeType.REMOVE** â€“ delete child automatically

Example:

```java
@OneToOne(cascade = CascadeType.ALL)
private Passport passport;
```

---

# ğŸŸ« **8. FETCH Types (Lazy vs Eager â€“ Beginner Level)**

### **LAZY (Recommended)**

Loads data only when required.

```
College loaded â†’ Students loaded only when needed
```

### **EAGER (Not recommended)**

Loads everything at once â†’ slow for big data.

Example:

```java
@OneToMany(fetch = FetchType.LAZY)
private List<Student> students;
```

---

# â­ **9. Mini Project**

Create:

### **Entities**

1. Customer
2. Address

Relationship: **One-to-One**

### Customer.java

```java
@OneToOne(cascade = CascadeType.ALL)
private Address address;
```

### Create CRUD APIs

* POST /customer
* GET /customer/{id}

JSON Example:

```json
{
  "name": "Kumar",
  "address": {
    "city": "Hyderabad",
    "pincode": "500001"
  }
}
```

Spring Boot should save **both tables** automatically.

---

# ğŸ“ **10. Assignments for Students**

### **Task 1 â€“ One-to-Many Example**

Create:

* Department (One)
* Employees (Many)

APIs:

* POST /department
* GET /department/{id}

---

### **Task 2 â€“ Many-to-Many Example**

Create:

* Students
* Courses

Each student can join multiple courses.

---

### **Task 3 â€“ Try FetchType Change**

Change LAZY â†’ EAGER
Observe difference in console logs.

---

